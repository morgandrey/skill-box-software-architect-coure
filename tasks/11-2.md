# ADR002. Выбор брокера сообщений

## Статус

Принято

## Контекст

Для анализа и выбора подходящего брокера сообщений для нашей архитектуры, нужно учесть следующие факторы и критерии:

1. Производительность: Необходимо выбрать брокера сообщений, который обеспечит высокую производительность при обмене сообщениями между сервисами. Учитывайте показатели пропускной способности (throughput) и задержек (latency) брокера сообщений.
2. Масштабируемость: Важно выбрать брокера сообщений, который может масштабироваться горизонтально при увеличении нагрузки. Убедитесь, что выбранный брокер сообщений поддерживает кластеризацию и автоматическое масштабирование.
3. Надежность и отказоустойчивость: Брокер сообщений должен быть надежным и обладать механизмами для обнаружения и восстановления отказов.
4. Управление и мониторинг: Важно выбрать брокера сообщений, который обеспечивает удобные инструменты для управления и мониторинга системы сообщений.

На основе вышеперечисленных факторов и требований, мы можем рассмотреть следующие варианты брокеров сообщений:

1. Apache Kafka: Kafka является распределенной платформой для обработки данных в реальном времени и широко используется в масштабных системах. Обладает высокой производительностью, масштабируемостью и отказоустойчивостью. Также хорошо интегрируется с различными технологиями и поддерживает множество языков программирования.
2. RabbitMQ: RabbitMQ является надежным и гибким брокером сообщений, который поддерживает различные протоколы обмена сообщениями. Предлагает широкий набор функций, включая маршрутизацию сообщений, очереди, управление ошибками и механизмы подтверждения.
3. ActiveMQ: ActiveMQ является открытым брокером сообщений, который обеспечивает высокую производительность и отказоустойчивость. Поддерживает широкий спектр протоколов и интегрируется с различными технологиями и платформами.

| Параметр                  | Apache Kafka   | RabbitMQ      | ActiveMQ       |
|---------------------------|----------------|---------------|----------------|
| Производительность        | 5              | 4             | 4              |
| Масштабируемость          | 5              | 4             | 4              |
| Надежность                | 5              | 4             | 4              |
| Отказоустойчивость        | 5              | 3             | 3              |
| Управление и мониторинг   | 4              | 4             | 4              |
| Интеграция с технологиями | 4              | 4             | 4              |
| Сложность использования   | 3              | 1             | 3              |

## Выбор
Используем Kafka.

## Последствия
- Получили надёжную часть нашей архитектуры, вокруг которой можем строить наши сервисы.
- Хорошая масштабируемость.